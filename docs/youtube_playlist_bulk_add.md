# YouTube プレイリスト一括レシピ追加機能 設計書

## 概要

ユーザーが YouTube のプレイリスト URL を入力し、プレイリスト内の動画情報を一括で取得・編集・選択し、レシピデータベースにまとめて登録できる機能を実装する。

---

## 機能要件

1. ユーザーがプレイリスト URL を入力
2. フロントエンドでプレイリスト URL を受け取る UI を用意
3. バックエンドで YouTube Data API を使い、動画一覧（動画 ID・タイトル・説明・サムネイル等）を取得
4. 取得した動画情報をレシピデータとして整形
   - タイトル → レシピ名
   - 説明 → 備考や食材抽出
   - サムネイル → 画像 URL
   - 動画 URL→YouTube URL
5. 取得した動画リストを画面に表示し、必要に応じて編集・選択して「一括追加」ボタンで API 送信

---

## 詳細設計

### 1. フロントエンド

- プレイリスト URL 入力フォームを用意
- 「取得」ボタンで API（例: `/api/youtube/playlist`）に URL を送信
- 取得した動画リストをテーブルやカード形式で表示
- 各動画ごとに編集（レシピ名・備考・サムネイル・使用食材など）・選択可
- 「一括追加」ボタンで選択した動画データをまとめてレシピ追加 API（例: `/api/recipes/bulk`）に POST

### 2. バックエンド

- エンドポイント例: `POST /api/youtube/playlist`
  - リクエスト: `{ "playlist_url": "..." }`
  - YouTube Data API v3（playlistItems, videos）で動画情報を取得
  - 必要に応じてタイトル・説明・サムネイル・動画 URL を抽出
  - レスポンス: 動画情報のリスト
- エンドポイント例: `POST /api/recipes/bulk`
  - リクエスト: レシピデータの配列
  - DB に一括登録

### 3. データ整形・自動抽出

- タイトル → レシピ名
- 説明 → 備考
- サムネイル URL→ 画像 URL
- 動画 URL→YouTube URL
- 説明文から食材名を自動抽出（食材テーブルと照合、部分一致）

### 4. 画面イメージ

- プレイリスト URL 入力欄＋取得ボタン
- 取得した動画リスト（編集・選択可）
- 一括追加ボタン

---

## 不足情報・確認事項

- YouTube Data API キーはバックエンドで安全に管理する想定でよいか？
- プレイリストが「非公開」の場合の対応（OAuth 認証は必要か？）
- 食材の自動抽出ロジックの詳細（完全一致/部分一致/正規表現など）
- レシピデータの必須項目・バリデーション要件
- 一括追加時の最大件数や制限
- 取得した動画情報の編集項目（どこまで編集可能にするか）

---

## 参考 API

- YouTube Data API v3
  - playlistItems: プレイリスト内の動画 ID 一覧取得
  - videos: 各動画の詳細情報取得

---

## 実装フロー例

1. フロントでプレイリスト URL 入力 →API 送信
2. バックエンドで YouTube Data API から動画情報取得 → 返却
3. フロントで動画リストを編集・選択 → 一括追加 API 送信
4. バックエンドで DB に一括登録

---

## その他

- 管理画面や一般ユーザー画面、どちらにも対応可能
- バックエンドで API キー・クォータ管理を徹底
- UI/UX 向上のため、取得・登録進捗やエラー表示も考慮

---

# 追加・修正が必要な情報があればご指示ください。

---
# AIの活用による機能改善案
YouTube動画解析の自動化（タイトル・概要欄・サムネイル・食材・手順の抽出）は、以下のAI・技術で実現可能です。

## 1. タイトル・概要欄・サムネイルの抽出

- **YouTube Data API**（公式API、無料枠あり）
  - 動画IDからタイトル・概要欄・サムネイルURLはAPIで直接取得可能
  - AI不要、APIキー取得だけでOK

---

## 2. 食材・手順の抽出（概要欄や字幕から）

- **Gemini（Googleの生成AI）やChatGPT API**
  - 概要欄や字幕テキストをプロンプトで渡し、「食材リスト」「手順」を抽出するよう指示
  - Gemini Pro（Web版）は無料枠あり。APIは有料だが低コスト（少量なら数円〜数十円/日）
  - ChatGPT（OpenAI）も同様に使える

- **無料/低コストでやる方法**
  - GeminiやChatGPTのWeb版を手動で使う（API課金不要）
  - OSSの自然言語処理ライブラリ（spaCy, NLTK, transformers）で食材名抽出（精度はAIより劣る）

---

## 3. 音声・字幕からの抽出

- **YouTubeの自動字幕取得＋Gemini/ChatGPTで要約・抽出**
  - 字幕データを取得し、AIに「食材・手順を抽出して」と指示
  - GeminiやChatGPTは日本語も対応

---

## まとめ

- タイトル・概要欄・サムネイル → YouTube Data API（無料）
- 食材・手順の抽出 → Gemini（Web版は無料枠あり）、ChatGPT（Web版も無料枠あり）、APIは低コスト
- OSSのNLPライブラリでも一部可能だが、精度は生成AIの方が高い

GeminiやChatGPTのWeb版を活用すれば、無料でかなりの部分が実現できます。API連携は少量なら低コストです。